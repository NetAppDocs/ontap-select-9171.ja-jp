---
sidebar: sidebar 
permalink: concept_stor_capacity_inc.html 
keywords: ontap select, deploy, increase storage 
summary: ONTAP Deploy を使用すると、 ONTAP Selectクラスタ内の各ノードに追加のストレージを追加し、ライセンスを取得できます。 
---
= ONTAP Selectのストレージ容量を増やす
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
ONTAP Deploy を使用すると、 ONTAP Selectクラスタ内の各ノードに追加のストレージを追加し、ライセンスを取得できます。

ONTAP Deployのストレージ追加機能は、管理対象ストレージを増やす唯一の手段であり、 ONTAP Select VMを直接変更することはサポートされていません。次の図は、ストレージ追加ウィザードを起動する「+」アイコンを示しています。

image:ST_05.jpg["クラスターとノードの詳細"]

容量拡張操作を成功させるには、以下の点に留意することが重要です。容量を追加するには、既存のライセンスで合計容量（既存容量と新規容量の合計）をカバーする必要があります。ストレージ追加操作によってノードのライセンス容量が超過した場合は、操作は失敗します。まず、十分な容量を持つ新しいライセンスをインストールする必要があります。

既存のONTAP Selectアグリゲートに容量を追加する場合、新しいストレージプール（データストア）のパフォーマンスプロファイルは既存のストレージプール（データストア）と同等である必要があります。AFFのようなパーソナリティ（フラッシュ対応）でインストールされたAFF ONTAP Selectノードには、SSD以外のストレージを追加できないことに注意してください。DASと外部ストレージの混在もサポートされていません。

追加のローカル（DAS）ストレージプールを提供するためにローカル接続ストレージをシステムに追加する場合は、追加のRAIDグループとLUN（または複数のLUN）を構築する必要があります。FASFASと同様に、同じアグリゲートに新しいスペースを追加する場合は、新しいRAIDグループのパフォーマンスが元のRAIDグループと同等であることを確認する必要があります。新しいアグリゲートを作成する場合、新しいアグリゲートのパフォーマンスへの影響を十分に理解していれば、新しいRAIDグループのレイアウトは異なる可能性があります。

データストアの合計サイズがサポートされる最大データストアサイズを超えない場合、新しいスペースを同じデータストアにエクステントとして追加できます。ONTAPONTAP Selectがすでにインストールされているデータストアへのデータストアエクステントの追加は動的に実行でき、 ONTAP Selectノードの動作に影響を与えません。

ONTAP Selectノードが HA ペアの一部である場合は、いくつかの追加の問題を考慮する必要があります。

HAペアでは、各ノードにパートナーのデータのミラー コピーが格納されます。ノード 1 にスペースを追加するには、同じ量のスペースをパートナーであるノード 2 に追加して、ノード 1 のすべてのデータがノード 2 に複製される必要があります。つまり、ノード 1 の容量追加操作の一部としてノード 2 に追加されたスペースは、ノード 2 では表示もアクセスもできません。スペースは、HA イベント中にノード 1 のデータが完全に保護されるように、ノード 2 に追加されます。

パフォーマンスに関して、追加の考慮事項があります。ノード1のデータはノード2に同期的に複製されます。そのため、ノード1の新しいスペース（データストア）のパフォーマンスは、ノード2の新しいスペース（データストア）のパフォーマンスと一致している必要があります。つまり、両方のノードにスペースを追加する際に、異なるドライブテクノロジーや異なるRAIDグループサイズを使用すると、パフォーマンスの問題が発生する可能性があります。これは、パートナーノードにデータのコピーを維持するために使用されるRAID SyncMirror操作が原因です。

HAペアの両ノードでユーザーがアクセス可能な容量を増やすには、各ノードに対して1つずつ、合計2つのストレージ追加操作を実行する必要があります。各ストレージ追加操作には、両ノードで追加のスペースが必要です。各ノードに必要な合計スペースは、ノード1に必要なスペースとノード2に必要なスペースの合計に等しくなります。

初期セットアップは2ノード構成で、各ノードには2つのデータストアがあり、各データストアには30TBの容量が割り当てられています。ONTAPONTAPは2ノードクラスタを作成し、各ノードはデータストア1から10TBの容量を消費しますONTAP Deployは各ノードに5TBのアクティブスペースを設定します。

次の図は、ノード1に対して単一のストレージ追加操作を実行した結果を示しています。ONTAP ONTAP Selectは、各ノードで依然として同量のストレージ（15TB）を使用しています。ただし、ノード1のアクティブストレージ（10TB）は、ノード2（5TB）よりも多くなっています。各ノードは他方のノードのデータのコピーをホストしているため、両ノードは完全に保護されています。データストア1には追加の空きスペースが残っており、データストア2は依然として完全に空きです。

*容量配分: 1回のストレージ追加操作後の割り当てと空き容量*

image:ST_06.jpg["容量配分: 1回のストレージ追加操作後の割り当てと空き容量"]

ノード1でさらに2回のストレージ追加操作が実行され、データストア1の残りとデータストア2の一部（容量上限を使用）が消費されます。最初のストレージ追加操作は、データストア1に残っていた15TBの空き容量を消費します。次の図は、2回目のストレージ追加操作の結果を示しています。この時点で、ノード1には50TBのアクティブデータが管理下にあり、ノード2には元の5TBが残っています。

*容量配分: ノード1の2回の追加ストレージ追加操作後の割り当てと空き容量*

image:ST_07.jpg["容量配分: ノード1の2回の追加ストレージ追加操作後の割り当てと空き容量"]

容量追加処理中に使用されるVMDKの最大サイズは16TBです。クラスタ作成処理中に使用されるVMDKの最大サイズは引き続き8TBです。ONTAPDeployは、構成（ONTAPノードクラスタまたはマルチノードクラスタ）と追加される容量に応じて適切なサイズのVMDKを作成します。ただし、各VMDKの最大サイズは、クラスタ作成処理中は8TB、ストレージ追加処理中は16TBを超えてはなりません。



== ソフトウェア RAID によるONTAP Selectの容量増加

同様に、ストレージ追加ウィザードを使用して、ソフトウェアRAIDを使用しているONTAP Selectノードの管理容量を増やすことができます。ウィザードには、ONTAP Select VMにRDMとしてマッピング可能な、使用可能なDAS SDDドライブのみが表示されます。

容量ライセンスを1TB単位で増やすことは可能ですが、ソフトウェアRAIDを使用する場合、物理的に1TB単位で容量を増やすことはできません。FASまたはAFFアレイにディスクを追加する場合と同様に、1回の操作で追加できるストレージの最小容量は、特定の要因によって決まります。

HAペアでは、ノード1にストレージを追加するには、そのノードのHAペア（ノード2）にも同数のドライブが利用可能である必要があります。ノード1では、ローカルドライブとリモートディスクの両方が、1回のストレージ追加操作で使用されます。つまり、リモートドライブは、ノード1の新しいストレージがノード2に複製され、保護されることを確認するために使用されます。ノード2にローカルで使用可能なストレージを追加するには、別のストレージ追加操作と、両ノードでそれぞれ同数のドライブが利用可能である必要があります。

ONTAP Select は、新しいドライブを既存のドライブと同じルート、データ、およびデータ パーティションにパーティション分割します。パーティショニング処理は、新しいアグリゲートの作成中、または既存のアグリゲートの拡張中に行われます。各ディスクのルート パーティション ストライプのサイズは、既存のディスクの既存のルート パーティション サイズと一致するように設定されます。したがって、2 つの同じデータ パーティション サイズはそれぞれ、ディスクの合計容量からルート パーティション サイズを差し引いて 2 で割ることで計算できます。ルート パーティションのストライプ サイズは可変であり、クラスタの初期セットアップ時に次のように計算されます。必要なルート スペースの合計（シングルノード クラスタの場合は 68 GB、HA ペアの場合は 136 GB）は、初期ディスク数からスペア ドライブとパリティ ドライブを差し引いた数に分割されます。ルート パーティションのストライプ サイズは、システムに追加されるすべてのドライブ上で一定に維持されます。

新しいアグリゲートを作成する場合、必要なドライブの最小数は、RAID タイプと、 ONTAP Selectノードが HA ペアの一部であるかどうかによって異なります。

既存のアグリゲートにストレージを追加する場合は、いくつかの追加の考慮事項があります。既存のRAIDグループにドライブを追加することは可能ですが、RAIDグループがすでに最大容量に達していないことが前提となります。既存のRAIDグループにスピンドルを追加するための従来のFASおよびAFFのベストプラクティスはここでも適用され、新しいスピンドルにホットスポットが発生する可能性が懸念されます。また、既存のRAIDグループに追加できるのは、既存のRAIDグループと同じかそれ以上のデータパーティションサイズのドライブのみです。前述のように、データパーティションサイズはドライブのRAWサイズと同じではありません。追加するデータパーティションが既存のパーティションよりも大きい場合、新しいドライブのサイズは適正化されます。つまり、新しいドライブの容量の一部は未使用のままになります。

新しいドライブを使用して、既存のアグリゲートの一部として新しいRAIDグループを作成することも可能です。この場合、RAIDグループのサイズは既存のRAIDグループのサイズと一致する必要があります。
