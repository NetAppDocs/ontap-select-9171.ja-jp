---
sidebar: sidebar 
permalink: concept_nw_single_multi_node.html 
keywords: ontap select, single node network configuration, multinode network configuration 
summary: ONTAP Select は、単一ノードとマルチノードの両方のネットワーク構成をサポートします。 
---
= ONTAP Selectの単一ノードおよび複数ノードのネットワーク構成
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
ONTAP Select は、単一ノードとマルチノードの両方のネットワーク構成をサポートします。



== 単一ノードネットワーク構成

単一ノードのONTAP Select構成では、クラスタ、HA、またはミラー トラフィックが存在しないため、 ONTAP内部ネットワークは必要ありません。

ONTAP Select製品のマルチノード バージョンとは異なり、各ONTAP Select VM には、 ONTAPネットワーク ポート e0a、e0b、e0c に提供される 3 つの仮想ネットワーク アダプタが含まれています。

これらのポートは、管理、データ、およびクラスタ間 LIF などのサービスを提供するために使用されます。

.KVM
ONTAP Selectはシングルノードクラスタとして導入できます。ハイパーバイザーホストには、外部ネットワークへのアクセスを提供する仮想スイッチが含まれています。

.ESXi
これらのポートと基盤となる物理アダプタの関係は、ESX ハイパーバイザ上の 1 つのONTAP Selectクラスタ ノードを示す次の図に示されています。

*シングルノードONTAP Selectクラスタのネットワーク構成*

image:DDN_03.jpg["シングルノードONTAP Selectクラスタのネットワーク構成"]


NOTE: 単一ノード クラスターには 2 つのアダプタで十分ですが、NIC チーミングは依然として必要です。



=== LIFの割り当て

このドキュメントのマルチノードLIFの割り当てセクションで説明されているように、 ONTAP SelectはIPspaceを使用してクラスタネットワークトラフィックをデータおよび管理トラフィックから分離します。このプラットフォームのシングルノードバリアントにはクラスタネットワークが含まれません。そのため、クラスタIPspaceにはポートが存在しません。


NOTE: クラスタおよびノード管理LIFは、 ONTAP Selectクラスタのセットアップ時に自動的に作成されます。残りのLIFは導入後に作成できます。



=== 管理およびデータ LIF (e0a、e0b、e0c)

ONTAPポート e0a、e0b、および e0c は、次のタイプのトラフィックを伝送する LIF の候補ポートとして委任されます。

* SAN/NAS プロトコル トラフィック (CIFS、NFS、iSCSI)
* クラスタ、ノード、SVM管理トラフィック
* クラスタ間トラフィック（SnapMirrorおよびSnapVault）




== マルチノードネットワーク構成

マルチノードONTAP Selectネットワーク構成は 2 つのネットワークで構成されます。

これらは、クラスタおよび内部レプリケーションサービスを提供する内部ネットワークと、データアクセスおよび管理サービスを提供する外部ネットワークです。これら2つのネットワーク内を流れるトラフィックをエンドツーエンドで分離することは、クラスタの回復力に適した環境を構築する上で非常に重要です。

これらのネットワークは次の図に示されています。これは、VMware vSphere プラットフォーム上で実行されている 4 ノードのONTAP Selectクラスタを示しています。6ノードおよび 8 ノードのクラスタでも同様のネットワーク レイアウトになります。


NOTE: 各ONTAP Selectインスタンスは個別の物理サーバ上に存在します。内部トラフィックと外部トラフィックは、各仮想ネットワークインターフェイスに割り当てられた個別のネットワークポートグループによって分離され、クラスタノード間で同じ物理スイッチインフラストラクチャを共有できるようになります。

* ONTAP Selectマルチノード クラスタ ネットワーク構成の概要*

image:DDN_01.jpg["ONTAP Selectマルチノードクラスタネットワーク構成の概要"]

各ONTAP Select VM には、7 つの仮想ネットワーク アダプタ（e0a ～ e0g）が含まれており、 ONTAPからは 7 つのネットワーク ポート（e0a ～ e0g）のセットとして認識されます。ONTAPはこれらのアダプタを物理 NIC として扱いますが、実際には仮想的なものであり、仮想ネットワーク層を介して物理インターフェースのセットにマッピングされます。そのため、各ホスティング サーバには 6 つの物理ネットワーク ポートは必要ありません。


NOTE: ONTAP Select VM への仮想ネットワーク アダプタの追加はサポートされていません。

これらのポートは、次のサービスを提供するために事前構成されています。

* e0a、e0b、e0g。管理LIFとデータLIF
* e0c、e0d：クラスタネットワークLIF
* e0eRSM
* e0fHAインターコネクト


ポートe0a、e0b、e0gは外部ネットワークに存在します。ポートe0cからe0fはそれぞれ異なる機能を持ちますが、全体として内部Selectネットワークを構成します。ネットワーク設計においては、これらのポートを単一のレイヤー2ネットワークに配置する必要があります。これらの仮想アダプタを異なるネットワークに分割する必要はありません。

これらのポートと基盤となる物理アダプタの関係を次の図に示します。この図は、ESX ハイパーバイザ上の 1 つのONTAP Selectクラスタ ノードを示しています。

*マルチノードONTAP Selectクラスタの一部である単一ノードのネットワーク構成*

image:DDN_02.jpg["マルチノードONTAP Selectクラスタの一部である単一ノードのネットワーク構成"]

内部トラフィックと外部トラフィックを異なる物理NICに分離することで、ネットワークリソースへのアクセス不足によるシステム遅延の発生を防止できます。さらに、NICチーミングによる集約により、単一のネットワークアダプタに障害が発生しても、 ONTAP Selectクラスタノードがそれぞれのネットワークにアクセスできなくなることはありません。

外部ネットワークポートグループと内部ネットワークポートグループの両方に、4つのNICアダプタがすべて対称的に含まれていることに注意してください。外部ネットワークポートグループのアクティブポートは、内部ネットワークのスタンバイポートになります。逆に、内部ネットワークポートグループのアクティブポートは、外部ネットワークポートグループのスタンバイポートになります。



=== LIFの割り当て

IPspaceの導入に伴い、 ONTAPポートのロールは廃止されました。FASFASと同様に、 ONTAP SelectクラスタにはデフォルトIPspaceとクラスタIPspaceの両方が含まれます。ネットワークポートe0a、e0b、e0gをデフォルトIPspaceに、ポートe0cとe0dをクラスタIPspaceに配置することで、これらのポートは実質的に、所属しないLIFのホスティングから隔離されます。ONTAPONTAP Selectクラスタ内の残りのポートは、内部サービスを提供するインターフェイスの自動割り当てによって使用されます。RSMおよびHAインターコネクトインターフェイスの場合のように、 ONTAPシェル経由では公開されません。


NOTE: すべてのLIFがONTAPコマンドシェルから表示できるわけではありません。HAインターコネクトとRSMインターフェースはONTAPからは非表示になっており、それぞれのサービスを提供するために内部的に使用されます。

ネットワーク ポートと LIF については、次のセクションで詳しく説明します。



=== 管理およびデータ LIF (e0a、e0b、e0g)

ONTAPポート e0a、e0b、および e0g は、次のタイプのトラフィックを伝送する LIF の候補ポートとして委任されます。

* SAN/NAS プロトコル トラフィック (CIFS、NFS、iSCSI)
* クラスタ、ノード、SVM管理トラフィック
* クラスタ間トラフィック（SnapMirrorおよびSnapVault）



NOTE: クラスタおよびノード管理LIFは、 ONTAP Selectクラスタのセットアップ時に自動的に作成されます。残りのLIFは導入後に作成できます。



=== クラスタ ネットワーク LIF (e0c、e0d)

ONTAPポートe0cおよびe0dは、クラスタインターフェイスのホームポートとして委任されます。各ONTAP Selectクラスタノードでは、 ONTAPのセットアップ時にリンクローカルIPアドレス（169.254.xx）を使用して2つのクラスタインターフェイスが自動的に生成されます。


NOTE: これらのインターフェイスには静的 IP アドレスを割り当てることはできず、追加のクラスター インターフェイスを作成しないでください。

クラスタネットワークトラフィックは、低レイテンシでルーティングされないレイヤ2ネットワークを通過する必要があります。クラスタのスループットとレイテンシの要件により、 ONTAP Selectクラスタは物理的に近接した場所（マルチパック、単一のデータセンターなど）に配置する必要があります。WAN経由または地理的に離れた場所にHAノードを分離して、4ノード、6ノード、または8ノードのストレッチクラスタ構成を構築することはサポートされていません。メディエータを使用した2ノードのストレッチ構成はサポートされています。

詳細については、link:reference_plan_best_practices.html#two-node-stretched-ha-metrocluster-sds-best-practices["2ノードストレッチHA（MetroCluster SDS）のベストプラクティス"] 。


NOTE: クラスタネットワークトラフィックの最大スループットを確保するため、このネットワークポートはジャンボフレーム（7500～9000 MTU）を使用するように設定されています。クラスタを適切に動作させるには、 ONTAP Selectクラスタノードに内部ネットワークサービスを提供する上流のすべての仮想スイッチと物理スイッチでジャンボフレームが有効になっていることを確認してください。



=== RAID SyncMirrorトラフィック（e0e）

HAパートナーノード間のブロックの同期レプリケーションは、ネットワークポートe0eにある内部ネットワークインターフェースを使用して実行されます。この機能は、クラスタのセットアップ時にONTAPによって設定されたネットワークインターフェースを使用して自動的に実行されるため、管理者による設定は不要です。


NOTE: ポートe0eは、 ONTAPによって内部レプリケーショントラフィック用に予約されています。そのため、このポートもホストLIFも、 ONTAP CLIまたはSystem Managerには表示されません。このインターフェイスは、自動生成されたリンクローカルIPアドレスを使用するように設定されており、代替IPアドレスの再割り当てはサポートされていません。このネットワークポートでは、ジャンボフレーム（7500～9000 MTU）を使用する必要があります。



=== HAインターコネクト（e0f）

NetApp FASアレイは、 ONTAPクラスタ内のHAペア間で情報をやり取りするために専用のハードウェアを使用します。しかし、ソフトウェア定義環境では、この種の機器（InfiniBandやiWARPデバイスなど）が利用できないことが多いため、代替ソリューションが必要になります。いくつかの可能性が検討されましたが、インターコネクトトランスポートに課せられたONTAPの要件により、この機能をソフトウェアでエミュレートする必要がありました。その結果、 ONTAP Selectクラスタでは、従来はハードウェアで提供されていたHAインターコネクトの機能がOSに組み込まれ、イーサネットをトランスポートメカニズムとして使用しています。

各ONTAP Selectノードには、HAインターコネクトポート（e0f）が設定されています。このポートは、以下の2つの主要な機能を担うHAインターコネクトネットワークインターフェイスをホストします。

* HAペア間でNVRAMの内容をミラーリングする
* HAペア間のHAステータス情報とネットワークハートビートメッセージの送受信


HA 相互接続トラフィックは、イーサネット パケット内にリモート ダイレクト メモリ アクセス (RDMA) フレームを階層化することにより、単一のネットワーク インターフェイスを使用してこのネットワーク ポートを通過します。


NOTE: RSMポート（e0e）と同様に、物理ポートもホストネットワークインターフェースも、 ONTAP CLIおよびSystem Managerのいずれのユーザーからも参照できません。そのため、このインターフェースのIPアドレスを変更したり、ポートの状態を変更したりすることはできません。このネットワークポートでは、ジャンボフレーム（7500～9000 MTU）を使用する必要があります。
