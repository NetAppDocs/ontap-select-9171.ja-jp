---
sidebar: sidebar 
permalink: concept_ha_config.html 
keywords: ontap select, high availability configurations, two-node ha, multi-node ha, mc sds 
summary: 高可用性オプションを確認して、環境に最適な HA 構成を選択します。 
---
= ONTAP Selectの高可用性構成
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
高可用性オプションを確認して、環境に最適な HA 構成を選択します。

お客様は、アプリケーションワークロードをエンタープライズクラスのストレージアプライアンスからコモディティハードウェア上で稼働するソフトウェアベースのソリューションに移行し始めていますが、レジリエンス（回復力）とフォールトトレランスに対する期待とニーズは変わっていません。ゼロ復旧ポイント目標（RPO）を提供するHAソリューションは、インフラストラクチャスタック内のいずれかのコンポーネントの障害によるデータ損失からお客様を保護します。

SDS 市場の大部分は、シェアードナッシング ストレージの概念に基づいて構築されており、ソフトウェア レプリケーションによって、異なるストレージ サイロに複数のユーザー データの複数のコピーを保存することでデータの復元力を実現しています。ONTAP Select はこの前提に基づいて構築されており、 ONTAPが提供する同期レプリケーション機能 (RAID SyncMirror ) を使用して、クラスタ内にユーザー データの追加コピーを保存します。これは、HA ペアのコンテキスト内で行われます。すべての HA ペアは、ユーザー データの 2 つのコピーを保存します。1 つはローカル ノードによって提供されるストレージに、もう 1 つは HA パートナーによって提供されるストレージにです。ONTAP Selectクラスタ内では、HA と同期レプリケーションが結び付けられており、2 つの機能を切り離したり、独立して使用したりすることはできません。そのため、同期レプリケーション機能はマルチノード オファリングでのみ使用できます。


NOTE: ONTAP Selectクラスタでは、同期レプリケーション機能はHA実装の機能であり、非同期SnapMirrorまたはSnapVaultレプリケーションエンジンの代替ではありません。同期レプリケーションは、HAとは独立して使用することはできません。

ONTAP Select HA導入モデルには、マルチノードクラスタ（4ノード、6ノード、または8ノード）と2ノードクラスタの2種類があります。2ノードONTAP Selectクラスタの顕著な特徴は、スプリットブレインシナリオを解決するために外部メディエーターサービスを使用することです。ONTAPDeploy VMは、構成ONTAPすべての2ノードHAペアのデフォルトのメディエーターとして機能します。

2 つのアーキテクチャは次の図に示されています。

*リモートメディエーターとローカル接続ストレージを使用した2ノードのONTAP Selectクラスタ*

image:DDHA_01.jpg["リモートメディエーターとローカル接続ストレージを使用した2ノードのONTAP Selectクラスタ"]


NOTE: 2ノードのONTAP Selectクラスタは、1つのHAペアと1つのメディエータで構成されます。HAペア内では、各クラスタノードのデータアグリゲートが同期的にミラーリングされるため、フェイルオーバーが発生してもデータが失われることはありません。

*ローカル接続ストレージを使用した 4 ノードのONTAP Selectクラスタ*image:DDHA_02.jpg["ローカル接続ストレージを使用した4ノードのONTAP Selectクラスタ"]

* 4ノードのONTAP Selectクラスタは、2つのHAペアで構成されています。6ノードと8ノードのクラスタは、それぞれ3つと4つのHAペアで構成されています。各HAペア内では、各クラスタノードのデータアグリゲートが同期的にミラーリングされ、フェイルオーバーが発生してもデータが失われることはありません。
* DASストレージを使用する場合、物理サーバ上に存在できるONTAP Selectインスタンスは1つだけです。ONTAPONTAP Selectは、システムのローカルRAIDコントローラへの非共有アクセスを必要とし、ローカル接続されたディスクを管理するように設計されています。これは、ストレージへの物理的な接続がなければ不可能です。




== 2ノードHAとマルチノードHA

FASアレイとは異なり、HAペアのONTAP SelectノードはIPネットワーク経由でのみ通信します。つまり、IPネットワークは単一障害点（SPOF）となり、ネットワーク分割やスプリットブレインシナリオに対する保護が設計の重要な側面となります。マルチノードクラスタは、3つ以上の残存ノードによってクラスタクォーラムを確立できるため、単一ノード障害にも耐えることができます。2ノードクラスタでは、 ONTAP Deploy VMがホストするメディエーターサービスを利用して同じ結果を実現します。

ONTAP SelectノードとONTAP Deploy メディエーター サービス間のハートビート ネットワーク トラフィックは最小限で、復元力に優れているため、 ONTAP Deploy VM をONTAP Select の2 ノード クラスタとは別のデータセンターでホストできます。


NOTE: ONTAP Deploy VMは、2ノードクラスタのメディエーターとして機能する場合、そのクラスタの不可欠な要素となります。メディエーターサービスが利用できない場合、2ノードクラスタは引き続きデータを提供しますが、 ONTAP Selectクラスタのストレージフェイルオーバー機能は無効になります。そのため、 ONTAP Deployメディエーターサービスは、HAペアの各ONTAP Selectノードとの継続的な通信を維持する必要があります。クラスタクォーラムが適切に機能するには、最小5Mbpsの帯域幅と最大125msのラウンドトリップ時間（RTT）レイテンシが必要です。

メディエータとして機能しているONTAP Deploy VM が一時的または永続的に使用できなくなる可能性がある場合は、セカンダリONTAP Deploy VM を使用して 2 ノード クラスタ クォーラムをリストアできます。これにより、新しいONTAP Deploy VM はONTAP Selectノードを管理できなくなりますが、クラスタ クォーラム アルゴリズムには正常に参加できるようになります。ONTAPONTAP SelectノードとONTAP Deploy VM 間の通信は、IPv4 経由の iSCSI プロトコルを使用して行われます。ONTAPONTAP Selectノードの管理 IP アドレスはイニシエータであり、 ONTAP Deploy VM の IP アドレスはターゲットです。したがって、2 ノード クラスタを作成するときに、ノード管理 IP アドレスとして IPv6 アドレスをサポートすることはできません。ONTAPONTAPがホストするメールボックス ディスクは、2 ノード クラスタの作成時に自動的に作成され、適切なONTAP Selectノードの管理 IP アドレスにマスクされます。設定全体はセットアップ時に自動的に実行されるため、それ以上の管理アクションは必要ありません。クラスタを作成するONTAP Deploy インスタンスは、そのクラスタのデフォルトのメディエータです。

元のメディエーターの場所を変更する必要がある場合は、管理アクションが必要です。元のONTAP Deploy VMが失われた場合でも、クラスタクォーラムをリカバリすることは可能です。NetAppでは、2ノード クラスタがインスタンス化されるたびにONTAP Deployデータベースをバックアップすることを推奨します。



== 2ノードHAと2ノードストレッチHA（MetroCluster SDS）

2ノードのアクティブ/アクティブHAクラスタをより長距離に拡張し、各ノードを異なるデータセンターに配置することも可能になります。2ノードクラスタと2ノードストレッチクラスタ（ MetroCluster SDSとも呼ばれます）の唯一の違いは、ノード間のネットワーク接続距離です。

2ノードクラスタとは、両ノードが同じデータセンター内に300m以内の距離にあるクラスタとして定義されます。通常、両ノードは同じネットワークスイッチまたはスイッチ間リンク（ISL）ネットワークスイッチセットへのアップリンクを備えています。

2ノードMetroCluster SDSは、ノードが物理的に300m以上（異なる部屋、異なる建物、異なるデータセンターなど）離れたクラスタとして定義されます。さらに、各ノードのアップリンク接続は別々のネットワークスイッチに接続されます。MetroClusterMetroClusterは専用のハードウェアを必要としません。ただし、環境はレイテンシ（RTTは最大5ms、ジッターは最大5ms、合計10ms）と物理的距離（最大10km）の要件を満たす必要があります。

MetroCluster SDSはプレミアム機能であり、PremiumライセンスまたはPremium XLライセンスが必要です。Premiumライセンスは、小規模および中規模のVM、およびHDDとSSDメディアの作成をサポートします。PremiumXLライセンスは、NVMeドライブの作成もサポートします。


NOTE: MetroCluster SDSは、ローカル接続ストレージ（DAS）と共有ストレージ（vNAS）の両方でサポートされています。vNAS構成では、ONTAP Select VMと共有ストレージ間のネットワークが原因で、通常、固有のレイテンシが高くなります。MetroClusterMetroCluster構成では、共有ストレージのレイテンシを含め、ノード間のレイテンシを最大10ミリ秒に抑える必要があります。つまり、これらの構成では共有ストレージのレイテンシが無視できないため、Select VM間のレイテンシのみを測定するだけでは不十分です。
